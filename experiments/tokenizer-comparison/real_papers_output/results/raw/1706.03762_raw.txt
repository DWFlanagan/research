Attention Is All You Need
Abstract
The dominant sequence transduction models are based on complex recurrent or convolutional neural
networks that include an encoder and a decoder. The best performing models also connect the encoder
and decoder through an attention mechanism. We propose a new simple network architecture, the
Transformer, based solely on attention mechanisms, dispensing with recurrence and convolutions
entirely. Experiments on two machine translation tasks show these models to be superior in quality
while being more parallelizable and requiring significantly less time to train. Our model achieves 28.4
BLEU on the WMT 2014 English-to-German translation task, improving over the existing best results,
including ensembles, by over 2 BLEU.
1 Introduction
Recurrent neural networks, long short-term memory and gated recurrent neural networks in particular,
have been firmly established as state of the art approaches in sequence modeling and transduction
problems such as language modeling and machine translation. Numerous efforts have since continued
to push the boundaries of recurrent language models and encoder-decoder architectures.
Attention mechanisms have become an integral part of compelling sequence modeling and
transduction models in various tasks, allowing modeling of dependencies without regard to their
distance in the input or output sequences. In all but a few cases, however, such attention mechanisms
are used in conjunction with a recurrent network.
In this work we propose the Transformer, a model architecture eschewing recurrence and instead
relying entirely on an attention mechanism to draw global dependencies between input and output. The
Transformer allows for significantly more parallelization and can reach a new state of the art in
translation quality after being trained for as little as twelve hours on eight P100 GPUs.
3 Model Architecture
Most competitive neural sequence transduction models have an encoder-decoder structure. Here, the
encoder maps an input sequence of symbol representations (x1, ..., xn) to a sequence of continuous
representations z = (z1, ..., zn). Given z, the decoder then generates an output sequence (y1, ..., ym) of
symbols one element at a time. The Transformer follows this overall architecture using stacked
self-attention and point-wise, fully connected layers for both the encoder and decoder.
3.1 Encoder and Decoder Stacks
Encoder: The encoder is composed of a stack of N = 6 identical layers. Each layer has two sub-layers.
The first is a multi-head self-attention mechanism, and the second is a simple, position-wise fully
connected feed-forward network. We employ a residual connection around each of the two sub-layers,
followed by layer normalization.
Decoder: The decoder is also composed of a stack of N = 6 identical layers. In addition to the two
sub-layers in each encoder layer, the decoder inserts a third sub-layer, which performs multi-head
attention over the output of the encoder stack.
3.2 Attention

An attention function can be described as mapping a query and a set of key-value pairs to an output,
where the query, keys, values, and output are all vectors. The output is computed as a weighted sum of
the values. We call our particular attention "Scaled Dot-Product Attention". We compute the dot
products of the query with all keys, divide each by sqrt(dk), and apply a softmax function to obtain the
weights on the values.
Attention(Q, K, V) = softmax(QK^T / sqrt(dk))V
6 Results
On the WMT 2014 English-to-German translation task, the big transformer model outperforms the best
previously reported models by more than 2.0 BLEU, establishing a new state-of-the-art BLEU score of
28.4.
7 Conclusion
In this work, we presented the Transformer, the first sequence transduction model based entirely on
attention, replacing the recurrent layers most commonly used in encoder-decoder architectures with
multi-headed self-attention.
